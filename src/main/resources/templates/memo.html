<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <title>노래방 일본 신곡 알림이 메모장</title>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name=”title” content="노래방 일본 신곡 알림이 메모장"/>
  <meta name="description" content="노래방 일본 신곡 알림이 에서 TJ, 금영 노래방에 등록되는 일본 신곡을 확인하고, 신곡 등록 정보를 메일로 받아보세요."/>
  <meta name="keywords" content="노래방, 일본 노래, 신곡"/>
  <meta name="google-site-verification" content="00_l8httzNCkM1xkzw0ksQyJ0uhLb2ZFP2POJnLB-Mk"/>
  <meta name="naver-site-verification" content="81d3e8c9dfbb40001d6dfddf06db7c3546ac03cd"/>
  <!--  <meta name="author" content=""/>-->
  <!-- Favicon-->
  <link rel="icon" type="image/x-icon" href="/static/assets/favicon_32.png" th:href="@{/assets/favicon_32.png}"/>
  <!-- Bootstrap icons-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet"
        type="text/css"/>
  <!-- nanum fonts-->
  <link href="https://hangeul.pstatic.net/hangeul_static/css/nanum-square-round.css" rel="stylesheet"/>
  <!-- Core theme CSS (includes Bootstrap)-->
  <link href="/static/css/styles.css" th:href="@{/css/styles.css}" rel="stylesheet"/>
  <link href="/static/css/containers.css" th:href="@{/css/containers.css}" rel="stylesheet"/>
  <link href="/static/css/header-text-size.css" th:href="@{/css/header-text-size.css}" rel="stylesheet"/>
  <link href="/static/css/song-table.css" th:href="@{/css/song-table.css}" rel="stylesheet"/>
  <link href="/static/css/modal.css" th:href="@{/css/modal.css}" rel="stylesheet"/>
  <link href="/static/css/footer.css" th:href="@{/css/footer.css}" rel="stylesheet"/>
  <link href="/static/css/memo.css" th:href="@{/css/memo.css}" rel="stylesheet"/>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-JFWLSXBEYR"></script>
  <script>
      // window.dataLayer = window.dataLayer || [];
      //
      // function gtag() {
      //     dataLayer.push(arguments);
      // }
      //
      // gtag('js', new Date());
      //
      // gtag('config', 'G-JFWLSXBEYR');
  </script>
  <style>
  </style>
  <script src="https://code.jquery.com/jquery.min.js"></script>
  <script src="/static/js/memo/add-memo-order-modal.js" th:src="@{/js/memo/add-memo-order-modal.js}"
          type="text/javascript"></script>
  <script src="/static/js/memo/song-search.js" th:src="@{/js/memo/song-search.js}" type="module"></script>
  <script src="/static/js/memo/fade-in.js" th:src="@{/js/memo/fade-in.js}" type="text/javascript"></script>
  <script src="/static/js/memo/switch-memo-order.js" th:src="@{/js/memo/switch-memo-order.js}" type="module"></script>
  <script src="/static/js/memo/delete-memo.js" th:src="@{/js/memo/delete-memo.js}" type="module"></script>
  <script src="/static/js/memo/memo-page-style-util.js" th:src="@{/js/memo/memo-page-style-util.js}"
          type="text/javascript"></script>
  <script src="/static/js/memo/save-memo.js" th:src="@{/js/memo/save-memo.js}" type="module"></script>
  <script src="/static/js/memo/memo-util.js" th:src="@{/js/memo/memo-util.js}" type="module"></script>
  <script type="module">
      // import MemoUtil from '/static/js/memo/memo-util.js'; // 로컬
      import MemoUtil from '/js/memo/memo-util.js';

      $(function () {
// alert
          let alertMessage = $('#alertMessage').text();
          if (alertMessage) {
              alert(alertMessage);
              $('#alertMessage').text('');
          }

          function initializeMemoTable() {
              let brand = $('#memoSettingForm').find('input[name=showMemoBrand]:checked').val();
              switch (brand) {
                  case 'ALL':
                      MemoUtil.refreshMemoTable('TJ');
                      MemoUtil.refreshMemoTable('KY');
                      break;
                  case 'TJ':
                      MemoUtil.refreshMemoTable('TJ');
                      $('.song-table-container').last().remove();
                      break;
                  case 'KY':
                      MemoUtil.refreshMemoTable('KY');
                      $('.song-table-container').first().remove();
                      break;
                  default: break;
              }
          }
          initializeMemoTable();

          $('#memoSettingForm').submit(function (event) {
              event.preventDefault();
              let formData = $(this).serialize();
              let userId = $('.memo-section-header').data('user-id');
              $.ajax({
                  url: '/users/' + userId,
                  type: 'PATCH',
                  data: formData,
                  success: function () {
                      initializeMemoTable();
                  }
              })
          })
      })
  </script>
</head>
<body>
<div id="alertMessage" th:text="${alertMessage}" style="width: 0; height: 0; display: none"></div>

<div id="container">
  <!-- Navigation-->
  <nav class="navbar navbar-light bg-light static-top">
    <div class="container">
      <h1>
        <a class="navbar-brand" href="/memo">노래방 일본곡 메모장</a>
      </h1>
      <div class="col-auto">
        <button class="btn btn-outline-dark btn-sm setting-Button" id="settingButton" data-bs-toggle="modal"
                data-bs-target="#settingModal">설정
        </button>
      </div>
    </div>
  </nav>

  <!--빈 테이블-->
  <div class="d-none song-table-border">
    <table class="empty-song-table song-table">
      <thead>
      <tr>
        <th>번호</th>
        <th>제목</th>
        <th>아티스트</th>
      </tr>
      </thead>
      <tbody>
      <tr>
        <td class="song-number">
          <span>12345</span>
        </td>
        <td class="song-title">
          <div>
            <a class="song-title-text">
              노래 제목
            </a>
          </div>
          <div class="song-info">
            <span>
            정보 텍스트
          </span>
          </div>
        </td>
        <td class="song-singer">가수명
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <!-- 설정 모달 -->
  <div class="modal fade" id="settingModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
       aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" id="unsubscribeModalHeaderText">설정</h4>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form class="forms-memo-setting forms" id="memoSettingForm">
            <div>표시 방식</div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="memoPresentType" id="memoPresentTypeByPresentOrder"
                     value="PRESENT_ORDER" th:checked="${memoPresentType.name().equals('PRESENT_ORDER')}">
              <label class="form-check-label" for="memoPresentTypeByPresentOrder">순서대로</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="memoPresentType" id="memoPresentTypeByArtist"
                     value="ARTIST" th:checked="${memoPresentType.name().equals('ARTIST')}">
              <label class="form-check-label" for="memoPresentTypeByArtist">아티스트별</label>
            </div>
            <hr>
            <div>표시할 메모</div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="showMemoBrand" id="showMemoBrandAll"
                     value="ALL" th:checked="${showMemoBrand.name().equals('ALL')}">
              <label class="form-check-label" for="showMemoBrandAll">모두</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="showMemoBrand" id="showMemoBrandTj"
                     value="TJ" th:checked="${showMemoBrand.name().equals('TJ')}">
              <label class="form-check-label" for="showMemoBrandTj">TJ</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="showMemoBrand" id="showMemoBrandKy"
                     value="KY" th:checked="${showMemoBrand.name().equals('KY')}">
              <label class="form-check-label" for="showMemoBrandKy">금영</label>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" id="unsubscribeModalCloseButton" class="btn btn-outline-secondary"
                  data-bs-dismiss="modal">닫기
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- 메모 테이블 -->
  <section class="memo-section bg-light text-center">
    <div id="song-container" class="container">
      <div class="memo-section-header" th:data-user-id="${userId}" }>
        <p th:text="${username + '님 의 메모된 곡 목록입니다.'}"> 메모된 곡 목록입니다. </p>
      </div>
      <div class="row">
        <!-- 태진 -->
        <div class="col-lg-4 fade-in-element song-table-container">
          <h2 class="song-header-text position-relative">
            <span>TJ 메모</span>
            <div class="header-button-wrapper position-absolute top-50 end-0 translate-middle-y">
              <!--            <button class="btn btn-outline-dark btn-sm setting-Button" id="refreshTJButton">갱신</button>-->
              <button id="switchOrderTjButton"
                      class="btn btn-xsm btn-outline-secondary collapse-button-hide-when-expanded switch-order-button"
                      type="button" data-bs-toggle="collapse"
                      data-bs-target="#switchOrderTjCollapse" aria-expanded="false"
                      aria-controls="switchOrderTjCollapse">
                순서변경
              </button>
              <button id="switchOrderTjCompleteButton"
                      class="btn btn-xsm btn-outline-primary switch-order-complete-button"
                      type="button">
                순서변경완료
              </button>
              <button id="deleteMemoTjButton"
                      class="btn btn-xsm btn-outline-danger collapse-button-hide-when-expanded delete-memo-button"
                      type="button" data-bs-toggle="collapse"
                      data-bs-target="#deleteMemoTjCollapse" aria-expanded="false" aria-controls="deleteMemoTjCollapse">
                삭제
              </button>
              <button id="deleteMemoTjCompleteButton" class="btn btn-xsm btn-outline-danger delete-memo-complete-button"
                      type="button">
                삭제완료
              </button>
            </div>
          </h2>
          <div class="switch-order-hint-collapse collapse" id="switchOrderTjCollapse">
            <span style="background-color: #fff3cd">처음 클릭한 곡</span>
            이
            <span style="background-color: #dddddd">두번째로 클릭한 곡</span>
            바로 아래 순서로 변경됩니다.<br>
            변경한 순서는 '순서변경완료' 버튼을 눌러야 적용됩니다.
          </div>
          <div class="delete-memo-hint-collapse collapse" id="deleteMemoTjCollapse">
            <span>삭제하려는 메모의 곡 제목을 클릭하면 삭제됩니다.</span>
          </div>
          <div class="song-table-border">
            <table class="song-table table-tj">
              <thead>
              <tr>
                <th>번호</th>
                <th>제목</th>
                <th>아티스트</th>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td class="song-number">
                  <span>12345</span>
                </td>
                <td class="song-title">
                  <div>
                    <a class="song-title-text">
                      노래 제목
                    </a>
                  </div>
                  <div class="song-info">
                    <span>
                      정보 텍스트
                    </span>
                  </div>
                </td>
                <td class="song-singer">가수명
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
        <!-- 금영 -->
        <div class="col-lg-4 fade-in-element song-table-container">
          <h2 class="song-header-text song-header-text-ky position-relative">
            <span>금영 메모</span>
            <div class="header-button-wrapper position-absolute top-50 end-0 translate-middle-y">
              <!--            <button class="btn btn-outline-dark btn-sm setting-Button" id="refreshTJButton">갱신</button>-->
              <button id="switchOrderKyButton"
                      class="btn btn-xsm btn-outline-secondary collapse-button-hide-when-expanded switch-order-button"
                      type="button" data-bs-toggle="collapse"
                      data-bs-target="#switchOrderTjCollapse" aria-expanded="false"
                      aria-controls="switchOrderTjCollapse">
                순서변경
              </button>
              <button id="switchOrderKyCompleteButton"
                      class="btn btn-xsm btn-outline-primary switch-order-complete-button"
                      type="button">
                순서변경완료
              </button>
              <button id="deleteMemoKyButton"
                      class="btn btn-xsm btn-outline-danger collapse-button-hide-when-expanded delete-memo-button"
                      type="button" data-bs-toggle="collapse"
                      data-bs-target="#deleteMemoTjCollapse" aria-expanded="false" aria-controls="deleteMemoTjCollapse">
                삭제
              </button>
              <button id="deleteMemoKyCompleteButton" class="btn btn-xsm btn-outline-danger delete-memo-complete-button"
                      type="button">
                삭제완료
              </button>
            </div>
          </h2>
          <div class="song-table-border">
            <table class="song-table table-ky">
              <thead>
              <tr>
                <th>번호</th>
                <th>제목</th>
                <th>아티스트</th>
              </tr>
              </thead>
              <tbody>
              <tr>
                <td class="song-number">
                  <span>12345</span>
                </td>
                <td class="song-title">
                  <div>
                    <a class="song-title-text">
                      노래 제목
                    </a>
                  </div>
                  <div class="song-info">
                    <span>
                      정보 텍스트
                    </span>
                  </div>
                </td>
                <td class="song-singer">가수명
                </td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="splitter"></div>

  <section class="add-memo-section bg-light text-center">
    <h2>
      <span>메모하기</span>
      <button id="addInfoTextCollapseButton" class="btn btn-outline-secondary collapse-button rounded-circle"
              type="button" data-bs-toggle="collapse"
              data-bs-target="#addInfoTextCollapse" aria-expanded="false" aria-controls="addTextCollapse">
        <i class="bi bi-caret-down-fill"></i>
      </button>
    </h2>

    <!--메모 추가 폼 -->
    <form id="memoAddForm">
      <input type="hidden" id="csrfToken" name="_csrf" th:value="${_csrf.token}"/>
      <div class="song-table-border">
        <table class="table song-table">
          <thead>
          <tr>
            <th>번호</th>
            <th>제목</th>
            <th>아티스트</th>
          </tr>
          </thead>
          <tbody>
          <tr class="add-song-row">
            <td class="song-number">
              <span>00000</span>
            </td>
            <td class="song-title">
              <div>
                    <span class="song-title-text">
                      노래를 검색해주세요
                    </span>
              </div>
              <div class="song-info">
                <span>추가텍스트: </span>
                <span class="ms-1">여기에 추가텍스트가 표시됩니다.</span>
              </div>
            </td>
            <td class="song-singer">
            </td>
          </tr>
          </tbody>
        </table>
      </div>

      <!-- 노래 추가 폼 - 추가 텍스트 부분 -->
      <div class="collapse mt-3" id="addInfoTextCollapse">
        <div class="row align-items-center justify-content-center mb-2">
          <div class="col-auto">
            <span>현재 저장 순서:&nbsp;</span><span id="currentPresentOrder">00</span>
          </div>
          <div class="col-auto">
            <button type="button" id="presentOrderModalButton" class="btn btn-outline-success btn-sm"
                    data-bs-toggle="modal"
                    data-bs-target="#presentOrderModal">저장 순서 변경
            </button>
          </div>
        </div>
        <div>
          <p class="mb-2">추가 텍스트를 입력할 수 있습니다. 비워둘 경우 노래의 기본값으로 등록됩니다.</p>
        </div>
        <div class="input-group mb-3">
            <textarea type="text" id="addInfoTextInput" class="form-control" placeholder="추가 텍스트"
                      aria-label="추가텍스트" aria-describedby=""></textarea>
          <button class="btn btn-outline-primary" type="submit" id="addSongButton">메모하기</button>
        </div>
      </div>
    </form>

    <!-- 저장 순서 모달 -->
    <div class="modal fade" id="presentOrderModal" tabindex="-1" aria-labelledby="presentOrderModal"
         aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">저장 순서 변경</h4>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="modal-body-content">
              <div>
                선택한 노래의 바로 다음 순서로 저장됩니다.<br>
              </div>
              <div class="song-table-border mt-2">
                <table class="table song-table" id="choosePresentOrderTable">
                  <thead>
                  <tr>
                    <th>번호</th>
                    <th>제목</th>
                    <th>아티스트</th>
                  </tr>
                  </thead>
                  <tbody>
                  </tbody>
                </table>
              </div>

            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">확인</button>
          </div>
        </div>
      </div>
    </div>

    <div id="searchHintContainer" class="mt-4 text-start">
      <p> 원어와 한국어로 모두 검색할 수 있습니다.</p>
      <p> 한글 검색결과는 정확하지 않을 수 있으며 모든 결과를 포함하지 않을 수 있습니다.</p>
      <p> 검색어는 띄어쓰기를 구분하며, 자세하게 입력할수록 결과가 정확해집니다.</p>
      <p> 예시 (정확도 순) Official髭男dism, 오피셜 히게 단디즘, 히게단</p>
    </div>

    <!--노래 검색 폼-->
    <form id="songSearchForm" class="my-4">
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="brand" id="searchBrandTj" value="TJ" checked>
        <label class="form-check-label" for="searchBrandTj">TJ</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="brand" id="searchBrandKy" value="KY">
        <label class="form-check-label" for="searchBrandKy">금영</label>
      </div>
      <span class="ms-5 me-5">|</span>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="searchType" id="searchTypeArtist" value="SINGER" checked>
        <label class="form-check-label" for="searchTypeArtist">아티스트명</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="searchType" id="searchTypeTitle" value="TITLE">
        <label class="form-check-label" for="searchTypeTitle">노래제목</label>
      </div>
      <div class="input-group mt-3">
        <input type="text" name="keyword" id="searchSongInput" class="form-control" placeholder="노래 제목 또는 아티스트명"
               aria-label="노래 제목 또는 아티스트명" aria-describedby="">
        <button class="btn btn-outline-primary" type="submit" id="searchSongButton">검색하기</button>
      </div>
    </form>

    <!--노래 검색 결과-->
    <h3>
      <span>검색결과</span>
      <button class="btn btn-outline-secondary rounded-circle collapse-button" id="songSearchResultCollapseButton"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#songSearchResultCollapse" aria-expanded="false" aria-controls="collapseExample">
        <i class="bi bi-caret-down-fill"></i>
      </button>
    </h3>

    <div class="collapse" id="songSearchResultCollapse">
      <div class="card card-body p-2">
        <div>
          노래 제목을 누르면 해당 노래가 폼에 자동으로 입력됩니다.<br>
          (한글 표시는 참고용으로 작성되었으며 정확하지 않습니다)
        </div>
        <div class="song-table-border mt-2">
          <table class="table-hover song-table" id="songSearchResultTable">
            <thead>
            <tr>
              <th>번호</th>
              <th>제목</th>
              <th>아티스트</th>
            </tr>
            </thead>
            <tbody id="songSearchResultTableBody">
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer-->
  <footer class="footer bg-light">
    <div class="container">
      <div class="row">
        <div class="col-lg-6 h-100 text-center text-lg-start my-auto">
          <p id="footerText" class="text-muted small mb-4 mb-lg-0">&copy; JsongNoti by spiaminto. All Rights
            Reserved.</p>
          <p id="footerTextCopyright" class="text-muted small mb-0">icons Designed by <a href="https://www.freepik.com/">Freepik</a></p>
          <p id="footerTextGoogleAnalytics" class="text-muted small mb-4 mb-lg-0">이 사이트는 구글 애널리틱스를 사용중입니다
            <button type="button" class="btn btn-outline-secondary google-analytics-button" data-bs-toggle="modal"
                    data-bs-target="#googleAnalyticsModal">
              [ 자세히 ]
            </button>
          </p>
        </div>
        <div class="col-lg-6 h-100 text-center text-lg-end my-auto">
          <ul class="list-inline mb-0">
            <li class="list-inline-item me-4">
              Github &nbsp;
              <a href="https://github.com/spiaminto/JsongNoti-web"><i class="bi-github fs-3"></i></a>
            </li>
            <li class="list-inline-item contact-mail-pc">
              Contact
              <a href="https://mail.google.com/mail/?view=cm&fs=1&to=jsongnoti%2Bcs@gmail.com&su=일본 신곡 알림이 문의"
                 target="_blank"><i
                  class="bi-envelope fs-3"></i></a>
            </li>
            <li class="list-inline-item contact-mail-mobile">
              Contact
              <a href="mailto:jsongnoti+cs@gmail.com?subject=일본 신곡 알림이 문의"><i
                  class="bi-envelope fs-3"></i></a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </footer>

  <!-- agreement Modal -->
  <div class="modal fade" id="googleAnalyticsModal" tabindex="-1" aria-labelledby="googleAnalyticsModal"
       aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" id="googleAnalyticsModalHeaderText">구글 애널리틱스</h4>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="modal-body-content">
            <p><h4>구글 애널리틱스 개인정보 처리 방침</h4> <br>
            노래방 일본 신곡 알림이는 보다 나은 서비스의 제공을 위하여 구글(Google)에서 제공하는 웹로그 분석 도구인 구글 애널리틱스를 이용하고 있습니다. <br>
            구글 애널리틱스는 쿠키(Cookie)를 통하여 현재 웹사이트 이용자의 행태정보를 수집하게 되며, 이 경우 이용자 개인을 식별할 수 없는 비식별정보 만이 수집됩니다. <br>
            그럼에도 이용자는 Google 애널리틱스 차단 브라우저 부가기능의 설치(https://tools.google.com/dlpage/gaoptout) 또는 웹브라우저의 쿠키 설정 거부를 통해 구글
            애널리틱스 이용을 거부할 수 있습니다.
            </p>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">확인</button>
        </div>
      </div>
    </div>
  </div>

</div> <!-- #container -->
<!-- Bootstrap core JS-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<!-- Core theme JS-->
<!--<script src="/js/song-search.js"></script>-->
</body>
</html>
